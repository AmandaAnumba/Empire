function fb_login(){FB.login(function(a){a.authResponse?(access_token=a.authResponse.accessToken,user_id=a.authResponse.userID,exp=new Date(a.authResponse.expiresIn).toISOString(),FB.api("/me",{fields:"first_name,last_name,cover,email"},function(a){email=a.email,first=a.first_name,last=a.last_name,pic=a.cover.source,console.log(pic),$.post("/fblogin",{name:first+" "+last,email:email,avatar:pic,token:access_token,id:user_id,expire:exp}).done(function(a){if(a.error&&($("#login_error #message").empty().append(a.error),$("#login_error, #login-form").show(),console.log("login error")),a.success){var b={id:a.uID,avatarUrl:a.avatar,authorUrl:"none",name:a.fullname,sessionType:"Facebook"};localStorage.setItem("currentUser",JSON.stringify(b)),window.location=a.location}}).fail(function(){$("#login_error #message").empty().append("<strong>Error: </strong>Please refresh the page and try again."),$("#login_error").show(),console.log("fatal error")})})):console.log("User cancelled login or did not fully authorize.")},{scope:"public_profile,email,user_friends"})}function fblogout(){FB.logout(function(a){console.log(a),location.reload()})}window.fbAsyncInit=function(){FB.init({appId:"345241442325838",oauth:!0,status:!0,cookie:!0,xfbml:!0,version:"v2.2"})},function(a,b,c){var d,e=a.getElementsByTagName(b)[0];a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src="//connect.facebook.net/en_US/sdk.js",e.parentNode.insertBefore(d,e))}(document,"script","facebook-jssdk");var user_pic;